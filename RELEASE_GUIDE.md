# GitHub Release 自动化指南

## 概述

已为项目配置了GitHub Actions自动化发布流程，当推送新的版本标签时，会自动构建Windows版本并发布到GitHub Release。

## 🚀 如何发布新版本

### 1. 准备发布

确保代码已经测试完毕并准备发布：

```bash
# 确保代码是最新的
git pull origin main

# 运行测试确保一切正常
cargo test
cargo build --release
```

### 2. 创建版本标签

使用语义化版本号创建标签：

```bash
# 创建标签（例如 v1.0.0）
git tag v1.0.0

# 推送标签到远程仓库
git push origin v1.0.0
```

### 3. 自动化流程

推送标签后，GitHub Actions会自动执行以下步骤：

1. **环境准备**
   - 检出代码
   - 设置Rust工具链
   - 配置缓存

2. **构建过程**
   - 执行 `cargo build --release`
   - 下载并设置UPX压缩工具
   - 使用UPX压缩可执行文件

3. **文件准备**
   - 重命名可执行文件为 `crack-windows-x64.exe`
   - 复制配置文件示例
   - 生成使用说明文档

4. **发布到GitHub**
   - 创建GitHub Release
   - 上传构建文件
   - 生成发布说明

## 📦 发布内容

每次发布会包含以下文件：

- `crack-windows-x64.exe` - Windows x64可执行文件（UPX压缩）
- `config-example.json` - 配置文件示例
- `README.txt` - 使用说明文档

## 🔧 CI脚本特性

### 触发条件
- 仅在推送以 `v` 开头的标签时触发
- 例如：`v1.0.0`、`v2.1.3`、`v1.0.0-beta`

### 构建优化
- 使用Rust缓存加速构建
- UPX压缩减小文件大小
- 详细的构建日志

### 发布信息
- 自动生成发布说明
- 包含构建信息和使用指南
- 友好的中文界面

## 📋 版本号规范

建议使用语义化版本号：

- `v1.0.0` - 主要版本发布
- `v1.1.0` - 功能更新
- `v1.0.1` - 错误修复
- `v1.0.0-beta` - 预发布版本

## 🛠️ 本地测试

在推送标签前，可以本地测试构建：

```bash
# 测试Release构建
cargo build --release

# 测试UPX压缩（需要先安装UPX）
upx --best --lzma target/release/crack.exe
```

## 📝 发布检查清单

发布前请确认：

- [ ] 代码已经充分测试
- [ ] 版本号符合语义化规范
- [ ] CHANGELOG已更新（如果有）
- [ ] 配置文件示例是最新的
- [ ] 文档已更新

## 🔍 监控发布

推送标签后，可以在以下位置监控构建进度：

1. **GitHub Actions页面**
   - 访问仓库的 Actions 标签页
   - 查看 "Release" 工作流状态

2. **Release页面**
   - 构建完成后会自动创建Release
   - 访问仓库的 Releases 页面查看

## ⚠️ 注意事项

1. **标签不可修改**
   - 一旦推送标签，不建议删除或修改
   - 如有问题，创建新的修复版本

2. **构建时间**
   - 完整构建大约需要5-10分钟
   - 包括依赖下载、编译和压缩

3. **文件大小**
   - UPX压缩可以显著减小文件大小
   - 通常可以减小50-70%的体积

## 🆘 故障排除

如果构建失败，检查以下项目：

1. **代码编译**
   - 确保 `cargo build --release` 本地成功
   - 检查依赖项是否正确

2. **权限问题**
   - 确保仓库有创建Release的权限
   - 检查GITHUB_TOKEN权限

3. **网络问题**
   - UPX下载可能因网络问题失败
   - 可以重新触发工作流

## 📞 支持

如果遇到问题，可以：

1. 查看GitHub Actions日志
2. 检查本文档的故障排除部分
3. 在仓库中创建Issue报告问题
